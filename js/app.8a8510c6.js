(function(t){function e(e){for(var r,s,l=e[0],c=e[1],i=e[2],h=0,d=[];h<l.length;h++)s=l[h],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,i||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,l=1;l<n.length;l++){var c=n[l];0!==a[c]&&(r=!1)}r&&(o.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={app:0},o=[];function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/v2map/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var i=0;i<l.length;i++)e(l[i]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},1951:function(t,e,n){},"512e":function(t,e,n){"use strict";n("1951")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Info"),n("Map"),n("InputGroup"),n("List",{attrs:{header:"Route : Points"}},t._l(t.getMarkers,(function(e,r){return n("div",{key:r,style:{background:e.selected?"tomato":"#555"},on:{click:function(n){return t.itemClick(e.latlng)}}},[n("div",{style:{padding:"10px",borderBottom:"2px solid #222"}},[n("div",[t._v("# marker "+t._s(r))]),n("div",{staticClass:"small"},[t._v("lat: "+t._s(e.latlng.lat)+" ")]),n("div",{staticClass:"small"},[t._v("lng: "+t._s(e.latlng.lng)+" ")])])])})),0)],1)},o=[],s=(n("d81d"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{height:"100vh",width:"100vw"}},[t.showMap?n("LMap",{ref:"mapel",staticStyle:{height:"100%"},attrs:{zoom:t.zoom,center:t.mapCenter,options:t.mapOptions},on:{"update:center":t.centerUpdate,"update:zoom":t.zoomUpdate,click:t.mapClicked}},[n("l-tile-layer",{attrs:{url:t.url,attribution:t.attribution}}),t.showMarkers?n("div",t._l(t.getMarkers,(function(e,r){return n("LLayerGroup",{key:r},[n("LMarker",{attrs:{latLng:e.latlng,icon:e.selected?t.selectedIcon:t.icon,draggable:t.moveMarker},on:{click:function(e){return t.markerClick(r)},dragend:function(e){return t.updateMarker(e,r)}}})],1)})),1):t._e(),t.drawPath?n("div",[n("LLayerGroup",[n("LPolyline",{attrs:{latLngs:t.getMarkers.map((function(t){return t.latlng})),weight:4}})],1)],1):t._e(),t.drawPath?n("div",[n("LLayerGroup",[n("LPolyline",{attrs:{latLngs:t.customPath.filter((function(e){return t.markers[e]&&t.markers[e].latlng})).map((function(e){return t.markers[e].latlng})),weight:3,color:"red"}})],1)],1):t._e()],1):t._e()],1)}),l=[],c=n("2909"),i=(n("d3b7"),n("6062"),n("3ca3"),n("ddb0"),n("a434"),n("99af"),n("e11e")),u=n("635f"),h=n("2699"),d=n("a40a"),f=n("4e2b"),g=n("1ebb"),p=(n("cb29"),n("2f62")),m=n("b85c"),v=(n("fb6a"),n("c740"),.25),k=5,M=50,b=2.5,O=10,y=5,_=20,w=function(t,e){return{lat:t,lng:e}},L=function(t,e,n){return{id:t,latlng:w(e,n),selected:!1}};function P(t,e){var n=6373,r=x(t.latlng.lat),a=x(t.latlng.lng),o=x(e.latlng.lat),s=x(e.latlng.lng),l=s-a,c=o-r,i=Math.pow(Math.sin(c/2),2)+Math.cos(r)*Math.cos(o)*Math.pow(Math.sin(l/2),2),u=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),h=n*u;return h}function x(t){return t*Math.PI/180}function j(t){for(var e=0,n=0;n<t.length-1;n++)e+=P(t[n],t[n+1]);return e}function C(t){var e=Object(c["a"])(t[0]);t.push(E(t[0]));for(var n=Array(t.length).fill(0),r=Object(c["a"])(t),a=new Set,o=[],s=0;s<M;s++){for(var l=[],i=0;i<r.length;i++)l.push({length:j(r[i]),indexInArray:i});l=l.sort((function(t,e){return t.length-e.length}));for(var u=[],h=0;h<(r.length-1<_?r.length-1:_);h++)u.push(r[l[h].indexInArray]);r=u;var d,f=A(JSON.parse(JSON.stringify(Object(c["a"])(r)))),g=[],p=Object(m["a"])(r);try{for(p.s();!(d=p.n()).done;){var y=d.value;g.push(j(y))}}catch(lt){p.e(lt)}finally{p.f()}for(var w=0,L=g[0],P=0;P<g.length;P++)L>g[P]&&(w=P,L=g[P]);var x=r[w];r=S(f);var C,R=Object(m["a"])(r);try{for(R.s();!(C=R.n()).done;){var z=C.value;Y(z,e);var N=Math.random();if(N>v)for(var X=0;X<k;X++)I(z)}}catch(lt){R.e(lt)}finally{R.f()}for(var D=0;D<r.length;D++){var J=JSON.stringify(r[D].map((function(t){return t.latlng})));a.has(J)||(a.add(J),o.push(D))}if(r.length>O){var U,G=[],W=Object(m["a"])(o);try{for(W.s();!(U=W.n()).done;){var $=U.value;G.push(r[$])}}catch(lt){W.e(lt)}finally{W.f()}r=G}var T,q=[],B=Object(m["a"])(r);try{for(B.s();!(T=B.n()).done;){var F=T.value;q.push(j(F))}}catch(lt){B.e(lt)}finally{B.f()}var H=Math.min.apply(Math,q),Z=[],K=H+H*b;if(r.length>O){for(var Q=0;Q<q.length;Q++)q[Q]<K&&Z.push(Q);var V,tt=[],et=Object(m["a"])(Z);try{for(et.s();!(V=et.n()).done;){var nt=V.value;tt.push(r[nt])}}catch(lt){et.e(lt)}finally{et.f()}r=tt}r.unshift(x),r.unshift(x),r.push(x)}for(var rt=0;rt<r.length;rt++)n[rt]=j(r[rt]);for(var at=0,ot=n[0],st=0;st<n.length;st++)ot>n[st]&&(at=st,ot=n[st]);return{route:r[at],length:ot}}function I(t){var e=Math.floor(Math.random()*t.length),n=Math.floor(Math.random()*t.length),r=t[e];t[e]=t[n],t[n]=r}function S(t){for(var e=[],n=0;n<t.start.length;n++)for(var r=0;r<t.end.length;r++)e.push([].concat(Object(c["a"])(t.start[n]),Object(c["a"])(t.end[r])));return e}function A(t){for(var e={start:[],end:[]},n=t[0].length,r=0,a=0;a<t.length;a++){if(r>y)break;var o=t[a].slice(0,n/2),s=t[a].slice(n/2,t[a].length);e.start.push(o),e.end.push(s),r++}return e}function E(t){var e=Object(c["a"])(t);return e.reverse(),e}function Y(t,e){for(var n=Array(e.length).fill(0).map((function(t,e){return{index:e,count:0}})),r=0;r<n.length;r++)n[t[r].id].count++;for(var a=function(e){for(var r=0;r<n[e].count-1;r++){var a=t.findIndex((function(t){if(null!==t)return t.id===n[e].index}));t[a]=null}},o=0;o<n.length;o++)a(o);for(var s=0;s<n.length;s++)if(0===n[s].count)for(var l=0;l<t.length-1;l++){var c=t.findIndex((function(t){return null===t}));t[c]=JSON.parse(JSON.stringify(e[n[s].index]));break}}function R(t){for(var e=Object(c["a"])(t),n=[],r=[],a=0;a<t.length;a++)r.push(L(a,t[a].latlng.lat,t[a].latlng.lng,!1));return n.push(r),e=C(n),e}r["a"].use(p["a"]);var z=new p["a"].Store({state:{map:{center:Object(i["latLng"])(62.601017,29.763573),zoom:12},showPoints:!0,drawPath:!0,selectPath:!1,addMarker:!1,moveMarker:!1,test:0,routeLength:0,inter:null,markers:Array(10).fill(0).map((function(){return{latlng:Object(i["latLng"])(62.601017+Math.random()/6-.05,29.763573+Math.random()/6-.05),selected:!1}})),customPath:[]},mutations:{test:function(){console.log(z)},setCenter:function(t,e){t.map.center=e},computeSome:function(t){var e=R(t.markers);t.markers=e.route,t.length=e.length}},getters:{moveMarker:function(t){return t.moveMarker}}}),N=z,X=(n("6cc5"),new Set);window.addEventListener("keydown",(function(t){X.add(t.key)})),window.addEventListener("keyup",(function(t){X.delete(t.key)}));var D={components:{LPolyline:u["a"],LMap:h["a"],LTileLayer:d["a"],LMarker:f["a"],LLayerGroup:g["a"]},mounted:function(){this.markers=N.state.markers},data:function(){return{zoom:13,center:Object(i["latLng"])(62.601017,29.763573),url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',currentZoom:13,currentCenter:Object(i["latLng"])(62.601017,29.763573),showParagraph:!1,mapOptions:{zoomSnap:.5},customPath:[],markers:[],selectedIndex:null,selectedIcon:Object(i["icon"])({iconUrl:"https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-512.png",iconSize:[64,74],iconAnchor:[32,74]}),icon:Object(i["icon"])({iconUrl:"https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-512.png",iconSize:[32,37],iconAnchor:[16,37]}),showMap:!0}},computed:{getMarkers:{get:function(){return N.state.markers},set:function(t){return t}},showMarkers:function(){return N.state.showPoints},drawPath:function(){return N.state.drawPath},selectPath:function(){return N.state.selectPath},addMarker:function(){return N.state.addMarker},moveMarker:function(){return N.state.moveMarker},mapCenter:function(){return N.state.map.center}},methods:{zoomUpdate:function(t){this.zoom=t},centerUpdate:function(t){this.currentCenter=t,this.center=t,N.commit("setCenter",t)},showLongText:function(){this.showParagraph=!this.showParagraph},gorandom:function(){this.centerUpdate(Object(i["latLng"])(47.41322,-1.219482))},mapClicked:function(t){if(console.log(this.selectedIndex),this.addMarker){if(null!==this.selectedIndex){console.log("put here ",this.selectedIndex);var e=Object(c["a"])(this.getMarkers),n=e.splice(this.selectedIndex+1),r=[].concat(Object(c["a"])(e),[{latlng:t.latlng,selected:!1}],Object(c["a"])(n));return this.markers=r,N.state.markers=r,this.getMarkers[this.selectedIndex].selected=!1,void(this.selectedIndex=null)}N.state.markers=[].concat(Object(c["a"])(this.getMarkers),[{latlng:t.latlng,selected:!1}])}},updateMarker:function(t,e){var n=this.getMarkers;n[e].latlng=t.target._latlng,this.getMarkers=n},markerClick:function(t){var e=this.getMarkers;if(this.selectPath&&(this.customPath=[].concat(Object(c["a"])(this.customPath),[t]),N.state.customPath=this.customPath),X.has("Shift")){if(null!==this.selectedIndex){var n=this.getMarkers,r=this.getMarkers[t];n[this.selectedIndex].selected=!1,n[t]=n[this.selectedIndex],n[this.selectedIndex]=r,this.getMarkers=n,this.selectedIndex=null}}else{if(X.has("Control")){var a=this.getMarkers;return a.splice(t,1),void(this.getMarkers=a)}if(null!==this.selectedIndex&&(e[this.selectedIndex].selected=!1),this.selectedIndex===t)return e[this.selectedIndex].selected=!1,this.getMarkers=e,void(this.selectedIndex=null);e[t].selected=!0,this.selectedIndex=t,this.getMarkers=e}}}},J=D,U=n("2877"),G=Object(U["a"])(J,s,l,!1,null,null,null),W=G.exports,$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"info-panel"},[t._v(" lat: "+t._s(t.mapCenter.lat)+" "),n("br"),t._v(" lng: "+t._s(t.mapCenter.lng)+" ")])},T=[],q={data:function(){return{}},computed:{mapCenter:{get:function(){return N.state.map.center}}}},B=q,F=(n("e385"),Object(U["a"])(B,$,T,!1,null,"c314db64",null)),H=F.exports,Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("LMarker")},K=[],Q={components:{LMarker:f["a"]},beforeMount:function(){console.log("marker mounted")}},V=Q,tt=Object(U["a"])(V,Z,K,!1,null,null,null),et=(tt.exports,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("button",{style:{background:t.showMarkers?t.ALLOW_COLOR:t.DENY_COLOR},on:{click:t.toggleMarkers}},[t._v(" show markers: "),n("b",[t._v(t._s(t.showMarkers))])]),n("button",{style:{background:t.showPath?t.ALLOW_COLOR:t.DENY_COLOR},on:{click:t.togglePath}},[t._v(" show markers: "),n("b",[t._v(t._s(t.showPath))])]),n("button",{style:{background:t.selectPath?t.ALLOW_COLOR:t.DENY_COLOR},on:{click:t.toggleSelectPath}},[t._v(" select path: "),n("b",[t._v(t._s(t.selectPath))])]),n("button",{style:{background:t.addMarker?t.ALLOW_COLOR:t.DENY_COLOR},on:{click:t.toggleAddMarker}},[t._v(" add marker: "),n("b",[t._v(t._s(t.addMarker))])]),n("button",{style:{background:t.moveMarker?t.ALLOW_COLOR:t.DENY_COLOR},on:{click:t.toggleMoveMarker}},[t._v(" move marker: "),n("b",[t._v(t._s(t.moveMarker))])]),n("button",{on:{click:t.computeSome}},[t._v(" compute ")])])}),nt=[],rt={components:{},data:function(){return{ALLOW_COLOR:"#4CD261",DENY_COLOR:"#F73830"}},computed:{showMarkers:{get:function(){return N.state.showPoints}},showPath:{get:function(){return N.state.drawPath}},selectPath:{get:function(){return N.state.selectPath}},addMarker:{get:function(){return N.state.addMarker}},moveMarker:{get:function(){return N.state.moveMarker}}},methods:{computeSome:function(){N.commit("computeSome")},testClick:function(){console.log("toggle test")},toggleMarkers:function(){N.state.showPoints=!N.state.showPoints},togglePath:function(){N.state.drawPath=!N.state.drawPath},toggleSelectPath:function(){N.state.selectPath=!N.state.selectPath},toggleAddMarker:function(){N.state.addMarker=!N.state.addMarker},toggleMoveMarker:function(){N.state.moveMarker=!N.state.moveMarker}}},at=rt,ot=(n("df42"),Object(U["a"])(at,et,nt,!1,null,"2c9af0f4",null)),st=ot.exports,lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container",style:{left:t.x+"px",top:t.y+"px"},attrs:{draggable:"true"},on:{dragend:t.updateXY,dragstart:t.calcStart}},[n("h4",[t._v(t._s(t.header)+" - "+t._s(t.getLength))]),t.show?n("div",{style:{maxHeight:"300px",overflow:"auto"}},[t._t("default")],2):t._e(),n("div",[n("button",{on:{click:t.toggle}},[n("span",[t._v(t._s(t.show?"close":"open"))])])])])},ct=[],it={props:{header:{type:String,default:"header"}},data:function(){return{startX:0,startY:0,x:100,y:100,show:!0}},computed:{getLength:function(){return N.state.routeLength}},methods:{toggle:function(){this.show=!this.show},calcStart:function(t){this.startX=t.clientX-this.x,this.startY=t.clientY-this.y,console.log("start : ",this.startX,this.startY)},updateXY:function(t){this.x=t.clientX-this.startX,this.y=t.clientY-this.startY}}},ut=it,ht=(n("512e"),Object(U["a"])(ut,lt,ct,!1,null,"c173b1ce",null)),dt=ht.exports,ft={components:{List:dt,Map:W,Info:H,InputGroup:st},computed:{getMarkers:function(){return console.log(N.state.markers),N.state.markers}},methods:{itemClick:function(t){console.log(t.lat),N.state.map.center=t}}},gt=ft,pt=(n("034f"),Object(U["a"])(gt,a,o,!1,null,null,null)),mt=pt.exports;r["a"].config.productionTip=!1,new r["a"]({el:"#app",store:N,render:function(t){return t(mt)}})},"5aa7":function(t,e,n){},"85ec":function(t,e,n){},"894c":function(t,e,n){},df42:function(t,e,n){"use strict";n("5aa7")},e385:function(t,e,n){"use strict";n("894c")}});
//# sourceMappingURL=app.8a8510c6.js.map